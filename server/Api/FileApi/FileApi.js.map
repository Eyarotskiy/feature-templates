{"version":3,"file":"FileApi.js","sourceRoot":"","sources":["FileApi.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,0CAAoB;AACpB,oDAAqE;AACrE,+CAAyB;AACzB,8CAAwB;AAExB;IAAA;IAkBA,CAAC;IAjBM,yCAAuB,GAA7B,UAA8B,GAAQ,EAAE,GAAY;;;;;;;wBAElD,IAAI,CAAC,YAAE,CAAC,UAAU,CAAC,yCAA6B,CAAC,EAAE;4BAClD,YAAE,CAAC,SAAS,CAAC,yCAA6B,CAAC,CAAC;yBAC5C;wBACM,IAAI,GAAI,GAAG,CAAC,KAAK,KAAb,CAAc;wBACnB,eAAe,GACpB,cAAI,CAAC,IAAI,CAAC,yCAA6B,EAAE,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;wBAC1D,qBAAM,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,EAAA;;wBAA9B,SAA8B,CAAC;wBACzB,MAAM,GAAG;4BACd,GAAG,EAAK,GAAG,CAAC,QAAQ,WAAM,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,SAAI,IAAI,CAAC,IAAM;yBACxD,CAAC;wBACF,aAAG,CAAC,WAAW,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;;;;wBAE7B,aAAG,CAAC,SAAS,CAAC,GAAG,EAAE,GAAG,EAAE,OAAK,CAAC,CAAC;;;;;;KAEhC;IACF,cAAC;AAAD,CAAC,AAlBD,IAkBC;AAED,kBAAe,IAAI,OAAO,EAAE,CAAC","sourcesContent":["import {Response} from 'express';\r\nimport fs from 'fs';\r\nimport {SERVER_STATIC_FILES_DIRECTORY} from '../../common/constants';\r\nimport Api from '../Api';\r\nimport path from 'path';\r\n\r\nclass FileApi {\r\n\tasync handleFileUploadRequest(req: any, res:Response): Promise<void> {\r\n\t\ttry {\r\n\t\t\tif (!fs.existsSync(SERVER_STATIC_FILES_DIRECTORY)) {\r\n\t\t\t\tfs.mkdirSync(SERVER_STATIC_FILES_DIRECTORY);\r\n\t\t\t}\r\n\t\t\tconst {file} = req.files;\r\n\t\t\tconst destinationPath =\r\n\t\t\t\tpath.join(SERVER_STATIC_FILES_DIRECTORY, '/', file.name);\r\n\t\t\tawait file.mv(destinationPath);\r\n\t\t\tconst result = {\r\n\t\t\t\turl: `${req.protocol}://${req.get('host')}/${file.name}`,\r\n\t\t\t};\r\n\t\t\tApi.sendSuccess(res, result);\r\n\t\t} catch (error) {\r\n\t\t\tApi.sendError(res, 500, error);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default new FileApi();\r\n"]}