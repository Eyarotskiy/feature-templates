{"version":3,"file":"Log.spec.js","sourceRoot":"","sources":["Log.spec.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,0CAAoB;AACpB,8CAAwB;AACxB,yDAAkE;AAClE,IAAM,IAAI,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AAElC,QAAQ,CAAC,KAAK,EAAE;IACf,UAAU,CAAC;QACV,YAAE,CAAC,aAAa,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;QAC7B,YAAE,CAAC,cAAc,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;QAC9B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC;YACvB,YAAE,CAAC,aAAa,CAAC,yBAAS,EAAE,8BAAc,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,2BAA2B,EAAE;QACrC,EAAE,CAAC,iDAAiD,EAAE;YACrD,aAAG,CAAC,yBAAyB,EAAE,CAAC;YAEhC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,gBAAgB,EAAE,CAAC;YACzC,MAAM,CAAC,YAAE,CAAC,aAAa,CAAC,CAAC,oBAAoB,CAAC,yBAAS,EAAE,8BAAc,CAAC,CAAC;QAC1E,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,gBAAgB,EAAE;QAC1B,EAAE,CAAC,sCAAsC,EAAE;;;;;wBACpC,UAAU,GAAG;4BAClB,IAAI,EAAE,GAAG;4BACT,OAAO,EAAE,MAAM;yBACf,CAAC;wBAEF,qBAAM,aAAG,CAAC,cAAc,CAAC,UAAU,CAAC,EAAA;;wBAApC,SAAoC,CAAC;wBAErC,MAAM,CAAC,YAAE,CAAC,cAAc,CAAC,CAAC,gBAAgB,EAAE,CAAC;;;;aAC7C,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC,CAAC","sourcesContent":["import fs from 'fs';\r\nimport Log from './Log';\r\nimport {TEST_FILE_DATA, TEST_PATH} from '../common/specConstants';\r\nconst cron = require('node-cron');\r\n\r\ndescribe('Log', () => {\r\n\tbeforeEach(() => {\r\n\t\tfs.writeFileSync = jest.fn();\r\n\t\tfs.appendFileSync = jest.fn();\r\n\t\tcron.schedule = jest.fn(() => {\r\n\t\t\tfs.writeFileSync(TEST_PATH, TEST_FILE_DATA);\r\n\t\t});\r\n\t});\r\n\r\n\tdescribe('initClearErrorFileCronJob', () => {\r\n\t\tit('should initialize file clear cron and save file', () => {\r\n\t\t\tLog.initClearErrorFileCronJob();\r\n\r\n\t\t\texpect(cron.schedule).toHaveBeenCalled();\r\n\t\t\texpect(fs.writeFileSync).toHaveBeenCalledWith(TEST_PATH, TEST_FILE_DATA);\r\n\t\t});\r\n\t});\r\n\r\n\tdescribe('logErrorToFile', () => {\r\n\t\tit('should save error stacktrace to file', async () => {\r\n\t\t\tconst TEST_ERROR = {\r\n\t\t\t\tcode: 400,\r\n\t\t\t\tmessage: 'test',\r\n\t\t\t};\r\n\r\n\t\t\tawait Log.logErrorToFile(TEST_ERROR);\r\n\r\n\t\t\texpect(fs.appendFileSync).toHaveBeenCalled();\r\n\t\t});\r\n\t});\r\n});\r\n"]}