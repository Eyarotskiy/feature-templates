{"version":3,"file":"Log.js","sourceRoot":"","sources":["Log.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,0CAAoB;AAEpB,iDAAwD;AACxD,yCAA2C;AAC3C,IAAM,IAAI,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AAElC;IAAA;IAkBA,CAAC;IAjBA,uCAAyB,GAAzB;QAAA,iBAIC;QAHA,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE;YAC1B,KAAI,CAAC,gBAAgB,EAAE,CAAC;QACzB,CAAC,CAAC,CAAC;IACJ,CAAC;IAEK,4BAAc,GAApB,UAAqB,KAAkB;;;;gBAChC,UAAU,GAAG,QAAM,kBAAU,EAAE,QAAK,CAAC;gBACrC,WAAW,GAAG,WAAS,KAAK,CAAC,IAAI,oBAAe,KAAK,CAAC,OAAO,QAAK,CAAC;gBACrE,YAAY,GAAG,UAAU,GAAG,WAAW,CAAC;gBAC5C,IAAI,KAAK,CAAC,KAAK;oBAAE,YAAY,IAAI,YAAU,KAAK,CAAC,KAAK,OAAI,CAAC;gBAC3D,YAAE,CAAC,cAAc,CAAC,+BAAmB,EAAE,YAAY,CAAC,CAAC;;;;KACrD;IAEO,8BAAgB,GAAxB;QACC,YAAE,CAAC,aAAa,CAAC,+BAAmB,EAAE,EAAE,CAAC,CAAC;IAC3C,CAAC;IACF,UAAC;AAAD,CAAC,AAlBD,IAkBC;AAED,kBAAe,IAAI,GAAG,EAAE,CAAC","sourcesContent":["import fs from 'fs';\r\nimport {ApiResponse} from '../common/types';\r\nimport {ERROR_LOG_FILE_PATH} from '../common/constants';\r\nimport {formatDate} from '../common/utils';\r\nconst cron = require('node-cron');\r\n\r\nclass Log {\r\n\tinitClearErrorFileCronJob() {\r\n\t\tcron.schedule('* * 1 * *', () => {\r\n\t\t\tthis.cleaErrorLogFile();\r\n\t\t});\r\n\t}\r\n\r\n\tasync logErrorToFile(error: ApiResponse) {\r\n\t\tconst dateString = `\\n[${formatDate()}]\\n`;\r\n\t\tconst errorString = `Code: ${error.code}.\\nMessage: ${error.message}.\\n`;\r\n\t\tlet resultString = dateString + errorString;\r\n\t\tif (error.stack) resultString += `Stack: ${error.stack}\\n`;\r\n\t\tfs.appendFileSync(ERROR_LOG_FILE_PATH, resultString);\r\n\t}\r\n\r\n\tprivate cleaErrorLogFile() {\r\n\t\tfs.writeFileSync(ERROR_LOG_FILE_PATH, '');\r\n\t}\r\n}\r\n\r\nexport default new Log(); \r\n"]}